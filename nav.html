<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <!-- <link rel="stylesheet" href="style.css"> -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/fontawesome.min.css" integrity="sha512-shT5e46zNSD6lt4dlJHb+7LoUko9QZXTGlmWWx0qjI9UhQrElRb+Q5DM7SVte9G9ZNmovz2qIaV7IWv0xQkBkw==" crossorigin="anonymous" />
  <title>BIBLIOSMIA</title>
  <style>
    html, body {
    max-width: 100%;
    overflow-x:hidden;
}
      .navbar.bg-light {
  background-color: #252525 !important;
  .form-control {
    border-radius: 4.25rem;
  }
}
.navbar-light .navbar-nav .nav-link {
    color: black;
}
.navbar-light .navbar-brand {
    color: white;
}
.navbar-light .navbar-brand {
    color: white;
}
.navbar-light .navbar-nav .nav-link {
    color: white;
}
.navbar-light .navbar-nav .nav-link:focus, .navbar-light .navbar-nav .nav-link:hover {
    color: white;
}
.navbar-light .navbar-brand:hover {
    color:white;
}
ul {
  list-style-type: none;
  font-weight: 0px;
}
a {
    color:black;
    text-decoration: none;
    background-color: transparent;
    margin-left:0px;
}

a:hover {
    color:black;
    text-decoration: none;
}
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 10rem;
    padding: .5rem 0;
    margin: .125rem 0 0;
    font-size: 1rem;
    color: #212529;
    text-align: left;
    list-style: none;
    background-color: #fff;
    background-clip: padding-box;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: .25rem;
    box-sizing: content-box;
}
.navbar-nav>li>.dropdown-menu {
    margin-top: 0;
    padding-left: 2px;
    padding-right: 10px;
    border-top-right-radius: 0;
    border-top-left-radius: 0;
}
li{
  margin-bottom:5px;
}
/* The message box is shown when the user clicks on the password field */
#message {
      display: none;
      background: #f1f1f1;
      color: #000;
      position: relative;
      padding: 20px;
      margin-top: 10px;
    }

    #message p {
      padding: 0px 35px;
      font-size: 18px;
    }

    /* Add a green text color and a checkmark when the requirements are right */
    .valid {
      color: green;
    }

    .valid:before {
      position: relative;
      left: -35px;
      content: "✔";
    }

    /* Add a red text color and an "x" when the requirements are wrong */
    .invalid {
      color: red;
    }

    .invalid:before {
      position: relative;
      left: -35px;
      content: "✖";
    }

    /*-------------------------------------------search style ------------------------------------------------*/

    .dropbtn {
  background-color: #4CAF50;
  color: white;
  padding: 16px;
  font-size: 16px;
  border: none;
  cursor: pointer;
 

}


.dropbtn:hover, .dropbtn:focus {
  background-color: #3e8e41;
}

#myInput {
  box-sizing: border-box;
  /* background-image: url('searchicon.png'); */
  background-position: 14px 12px;
  background-repeat: no-repeat;
  font-size: 16px;
  padding: 14px 20px 12px 45px;
  border: none;
  border-bottom: 1px solid #252525;
}

#myInput:focus {outline: 3px solid #252525;}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f6f6f6;
  min-width: 230px;
  overflow: scroll;
  height: 250px;
  border: 1px solid #252525;
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* .dropdown a:hover {background-color: #ddd;} */

.show {display: block;}
#txt{
        text-decoration:none;
      }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-light sticky-top">
    <a class="navbar-brand" href="index.php" style="font-size: 30px; padding-left:10px;">
    <!-- <img src="https://getbootstrap.com/docs/4.3/assets/brand/bootstrap-solid.svg" style="width:50px; height:50px;" class="d-inline-block align-top" alt=""> -->
    BIBLIOSMIA
  </a>
   <div>
    <form class="form-inline  ">
      <input class="form-control mr-sm-2" id="myInput" onclick="myFunction()" onkeyup="filterFunction()" type="search" placeholder="Search" aria-label="Search" style="border-radius:0px;">
    </form>
    <div id="myDropdown" class="dropdown-content"></div>
  </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent1" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent1">
      <div class="mr-auto"></div>
      <ul class="navbar-nav my-2 my-lg-0">

      <nav class="navbar navbar-expand-lg">
        <div class="collapse navbar-collapse" id="navbarSupportedContent1">
          <ul class="navbar-nav mr-auto">
            <li id="outdiv" class="nav-item dropdown margin">
              <a class="nav-link" id="un" role="button" data-toggle="dropdown"
                aria-haspopup="true" aria-expanded="false" data-target="#my-target">
                <i class="fas fa-user"></i>&nbsp;Profile
              </a>
              <div id="my-target" class="dropdown-menu" aria-labelledby="navbarDropdown">
                <ul>
                  <li><a href="myads.php"><i class="fas fa-ad"></i>&nbsp;My Ads</a></li>
                  <li><a href="favourites.php"><i class="fas fa-heart"></i>&nbsp;My Favourites</a></li>
                  <li><a href="addproduct.php"><i class="fas fa-plus-circle"></i>&nbsp;Add Product</a></li>
                  <!-- <li><a href="#"><i class="fas fa-wallet"></i>&nbsp;Orders & Billing</a></li>
                  <li><a href="#"><i class="fas fa-question-circle"></i>&nbsp;Help</a></li> -->
                  <li  onclick="logout(event)"><a href="#"><i class="fas fa-sign-out-alt"></i>&nbsp;Logout</a></li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </nav>
      <nav class="navbar navbar-expand-lg">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li id="in-out" class="nav-item dropdown">
              <a class="nav-link" id="navbarDropdown" role="button" data-toggle="dropdown"
                aria-haspopup="true" aria-expanded="false" data-target="#my-target1">
                <i class="fas fa-sign-in-alt ml-3"></i>&nbsp;Login/Signup
              </a>
              <div id="my-target1" class="dropdown-menu" aria-labelledby="navbarDropdown">
                <ul>
                  <li><a href="#" data-toggle="modal" data-target="#signinPage"><i class="fas fa-sign-in-alt ml-3"></i>&nbsp;Login</a></li>
                  <li><a href="#" data-toggle="modal" data-target="#signupPage"><i class="fas fa-user-plus ml-3"></i>&nbsp;Signup</a></li>
                 
                </ul>
              </div>
            </li>
          </ul>
          <!-- <form class="form-inline my-2 my-lg-0">
        <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
      </form> -->
        </div>
      </nav>
      </ul>
      </div>
      
  </nav>
  <!-- --------------------------------------------login model -------------------------------------------------------- -->
  <div class="modal fade" id="signinPage">
    <form  onsubmit="lfunc(event)" action="nav.html" style="text-align: center; border-radius:0%;">
  <div class="modal-dialog" style="border-radius:0%;">
    <div class="modal-content" style="height:60%; border-radius:0px; background-color: white;">
       <div class="modal-header text-center" style="background-color:white; border-radius:0px;">
         <h3 class="modal-title w-100 dark-grey-text font-weight-bold" style="color:black; margin-top:20px;">Sign In</h3>
         <button type="button" class="close" data-dismiss="modal" aria-lable="close">&times;</button> 
       </div>
       <div class="modal-body mx-4">
         <div class="md-form">
         <label data-error="wrong" data-success="right">Your Email</label>
         <input type="email" class="form-control validate" name="lname" id="user"  style=" color:black; background-color: white; border-radius:0%; text-align:center; border-color:black; "required>
         </div>
         <div class="md-form">
         <label data-error="wrong" data-success="right">Your Password</label>
         <input type="password" class="form-control validate" id="pass" name="lpassword" style=" color:black; background-color: white; border-radius:0%; text-align:center; border-color:black; " required>
         <!-- <p class="font-small blue-text d-flex justify-content-center"><a href="#" class="blue-text ml-1">Forgot Password?</a></p> -->
         </div>
         <br>
         <div class="text-center mb-3">
         <button type="submit"  class="btn btn-primary btn-block z-depth-la" style="background-color:black; color:white;border-radius:0px; border-style:solid; border-color:rgba(143, 4, 34, 0.973); width:100%; background-color:rgba(143, 4, 34, 0.973);">Sign In</button>
         <span class="font-small text-black d-flex justify-content-left" data-toggle="modal" data-target="#forgot">Forgot Password?</span>
         </div>
        
         <p class="font-small dark-grey-text d-flex justify-content-center">or sign in with:</p>
         <div class="row my-3 justify-content-center"></div>
         <button type="button" class="btn btn-danger btn-block z-depth-la" style="background-color:black; color:white;border-radius:0px; border-style:solid; border-color:black; width:100%; background-color:black;" onclick="glogin(event)">Sign In With Google&nbsp;<i class="fab fa-google text-center"></i></button><br>
         <p class="font-small dark-grey-text d-flex justify-content-center">or sign in with:</p>

         <a id="txt" href="otp.php"><button type="button" class="btn btn-danger btn-block z-depth-la" style="background-color:black; color:white;border-radius:0px; border-style:solid; border-color:rgba(143, 4, 34, 0.973); width:100%; background-color:rgba(143, 4, 34, 0.973);">Sign In With Phone Number</button></a>
       </div>
      </form>
    </div>
  </div>
</div>

<!-- ------------------------------------------forget password model----------------------------------------------------- -->
<div class="modal fade" id="forgot" style="width:100%;">
  <div class="modal-dialog">
    
     <div class="modal-content">
       <div class="modal-header text-center">
          <h4 class="modal-title text-center w-100 font-weight-bold">Enter your e-mail and we'll send you a link to reset your password :) </span></h4>
          <button type="button" class="close" data-dismiss="modal" aria-lable="close">&times;</button> 
       </div>
       
       <div class="modal-body mx-3">
          <div class="d-flex flex-row mt-5">
            <form style="width: 28rem;">
            <input type="email" class="form-control validate" name="email" id="email"  style=" color:black; background-color: white; border-radius:0%; text-align:center; border-color:black;"  required>
          </form>
          </div>
       </div>
      
       <div class="modal-footer d-flex justify-content-center">
       <button class="btn" style="background-color:black; color:white;border-radius:0px; border-style:solid; border-color:rgba(143, 4, 34, 0.973); width:30%; background-color:rgba(143, 4, 34, 0.973);" onclick="resetpass(event)"  data-toggle="modal" data-target="#details1">Submit</button>
       </div>
     </div>
     
  </div>
</div>


<!-- ------------------------------------------------------sign up model ------------------------------------------------------------------ -->
<div class="modal fade" id="signupPage" >
  <form onsubmit="sfunc(event)" style="text-align:left;">
  <div class="modal-dialog">
     <div class="modal-content" style="height:60%; border-radius:0px;">
       <div class="modal-header text-center" style="background-color:white; border-radius:0px;">
          <h4 class="modal-title text-center w-100 font-weight-bold" style="color:black; margin-top:20px;">Sign Up</h4>
          <button type="button" class="close" data-dismiss="modal" aria-lable="close">&times;</button> 
       </div>
       <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <i class="fas fa-user prefix grey-text"></i>
          <label data-error="wrong" data-success="right" style="text-align:center;">Your Name</label>
          <input type="text" class="form-control validate" name="Username" id="Username" style="border-color:black; border-radius:0px;" required>
          </div>
        <div class="md-form mb-5">
          <i class="fas fa-envelope prefix grey-text"></i>
          <label data-error="wrong" data-success="right">Your Email</label>
          <input type="email" class="form-control validate" id="Email" name="Email" style="border-color:black; border-radius:0px;" required>
        </div>
        <div class="md-form mb-5">
          <i class="fas fa-lock prefix grey-text"></i>
          <label data-error="wrong" data-success="right">Your Password</label>
          <input type="password" class="form-control validate"   id="Password" name="Password" style="border-color:black; border-radius:0px;" required>
        </div>
        <div id="message">
          
          <p id="letter" class="invalid">A <b>lowercase</b> letter</p>
          <p id="capital" class="invalid">A <b>capital (uppercase)</b> letter</p>
          <p id="number" class="invalid">A <b>number</b></p>
          <p id="length" class="invalid">Minimum <b>8 characters</b></p>
        </div>
        <div class="md-form mb-5">
          <i class="fas fa-phone-alt prefix grey-text"></i>
          <label data-error="wrong" data-success="right">Phone number</label>
          <input type="text" class="form-control validate" name="Num" id="Num" pattern="[1-9]{1}[0-9]{9}" style="border-color:black; border-radius:0px;" required>
        </div>
       </div>

       <div class="modal-footer d-flex justify-content-center">
       <button class="btn" style="background-color:black; color:white;border-radius:0px; border-style:solid; border-color:rgba(143, 4, 34, 0.973); width:100%; background-color:rgba(143, 4, 34, 0.973);">SignUp</button>
       </div>
     </div>
  </div>
</form>
</div>

  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-app.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
 https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-database.js"></script>

  <script>
    
document.onkeydown = function(e) {
  if(event.keyCode == 123) {
     return false;
  }
  if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
     return false;
  }
  if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) {
     return false;
  }
  if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
     return false;
  }
  if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
     return false;
  }
}
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional

    var firebaseConfig = {

      apiKey: "AIzaSyAe_khBjSfyamG4qM3f_kr09UlNZ0izzNQ",
      authDomain: "test-project-89dc8.firebaseapp.com",
      databaseURL: "https://test-project-89dc8-default-rtdb.firebaseio.com",
      projectId: "test-project-89dc8",
      storageBucket: "test-project-89dc8.appspot.com",
      messagingSenderId: "533975996944",
      appId: "1:533975996944:web:54bad50505b9bfbe878895",
      measurementId: "G-XB90JFQZXT"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
    const db = firebase.firestore();

//----------------- --------------------------------------------on page load-------------------------------------------------------------------

// to add subcollection 

// db.collection("rooms").doc("roomA").collection("messages").doc("message1").set({username:"demo"}).then(()=>{
//   console.log("added");
// })  ;

// to get single doc

// var docRef = db.collection("rooms").doc("roomA").collection("messages");

// docRef.get().then((doc) => {
//     if (doc.exists) {
//         console.log("Document data:", doc.data());
//     } else {
//         // doc.data() will be undefined in this case
//         console.log("No such document!");
//     }
// }).catch((error) => {
//     console.log("Error getting document:", error);
// });

// to get multiple doc
// db.collection("Users")
//     .get()
//     .then((querySnapshot) => {
//         querySnapshot.forEach((doc) => {
//             // doc.data() is never undefined for query doc snapshots
//             console.log(doc.id, " => ", doc.data());
//         });
//     })
//     .catch((error) => {
//         console.log("Error getting documents: ", error);
//     });

//---------------------------------- to display username on home page------------------------------------------

    firebase.auth().onAuthStateChanged(function (user) {
      if (user) {
        // User is signed in.
        document.getElementById("in-out").style.display = "none";
        var user = firebase.auth().currentUser;
        var name = user.displayName;
        if (name == null) {
          db.collection('Users').doc(user.uid).get().then(doc => {
            document.getElementById("un").innerText = doc.data().username;
          })
        } else {
          // User is signed in.
          console.log(user.displayName);
          document.getElementById("un").innerText = user.displayName;
        }
      } else {
        // No user is signed in.
        document.getElementById("outdiv").style.display = "none";
        
        console.log("no user signin");
      }

    });

    var myInput = document.getElementById("Password");
    var letter = document.getElementById("letter");
    var capital = document.getElementById("capital");
    var number = document.getElementById("number");
    var length = document.getElementById("length");

    // When the user clicks on the password field, show the message box
    myInput.onfocus = function () {
      document.getElementById("message").style.display = "block";
    }

    // When the user clicks outside of the password field, hide the message box
    myInput.onblur = function () {
      document.getElementById("message").style.display = "none";
    }

    // When the user starts to type something inside the password field
    myInput.onkeyup = function () {
      // Validate lowercase letters
      var lowerCaseLetters = /[a-z]/g;
      if (myInput.value.match(lowerCaseLetters)) {
        letter.classList.remove("invalid");
        letter.classList.add("valid");
      } else {
        letter.classList.remove("valid");
        letter.classList.add("invalid");
      }

      // Validate capital letters
      var upperCaseLetters = /[A-Z]/g;
      if (myInput.value.match(upperCaseLetters)) {
        capital.classList.remove("invalid");
        capital.classList.add("valid");
      } else {
        capital.classList.remove("valid");
        capital.classList.add("invalid");
      }

      // Validate numbers
      var numbers = /[0-9]/g;
      if (myInput.value.match(numbers)) {
        number.classList.remove("invalid");
        number.classList.add("valid");
      } else {
        number.classList.remove("valid");
        number.classList.add("invalid");
      }

      // Validate length
      if (myInput.value.length >= 8) {
        length.classList.remove("invalid");
        length.classList.add("valid");
      } else {
        length.classList.remove("valid");
        length.classList.add("invalid");
      }
    }

  

    //------------------------------ to delete collection -------------------------------------
    // async function del(e){
    //   db.collection("users").doc("lovelace").delete();
    //   console.log("done");
    // }

//--------------------------------------------------- google signin------------------------------------------------------------------

    async function glogin(e) {
      var provider = new firebase.auth.GoogleAuthProvider();

      firebase.auth()
        .signInWithPopup(provider)
        .then((result) => {
          /** @type {firebase.auth.OAuthCredential} */
          var credential = result.credential;

          // This gives you a Google Access Token. You can use it to access the Google API.
          var token = credential.accessToken;
          // The signed-in user info.
          var user = result.user;

          var user = firebase.auth().currentUser;
          console.log("hii");


          if (user != null) {
            console.log("hii2");
            user.providerData.forEach(function (profile) {
              // console.log("Sign-in provider: " + profile.providerId);
              userId = profile.uid;
              // console.log("  Name: " + profile.displayName);
              // console.log("  Email: " + profile.email);
              // console.log("  Photo URL: " + profile.photoURL);
              // console.log("  Photo URL: " + profile.number);

              // firebase.database().ref('userss/' + userId).set({
              //   username: profile.displayName,
              //   email: profile.email,
              //   profile_picture: profile.photoURL,
              //   // M_number: pnum,
              // });
              // Add a new document in collection "cities"

              db.collection("Users").doc(userId).set({
                username: profile.displayName,
                email: profile.email,
                profile_picture: profile.photoURL,
              })
                .then(() => {
                  console.log("Document successfully written!");
                  window.location.reload();
                })
                .catch((error) => {
                  console.error("Error writing document: ", error);
                });

            });

          }

          // ...
        }).catch((error) => {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // The email of the user's account used.
          var email = error.email;
          // The firebase.auth.AuthCredential type that was used.
          var credential = error.credential;
          // ...
        });

      
    }
// ---------------------------------------------------login function----------------------------------------------------------
    async function lfunc(e) {
      e.preventDefault();
      alert("hello")
      var email = document.getElementById('user').value;
      var password = document.getElementById('pass').value;
      console.log("hii");
      firebase.auth().signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Signed in
          // var user = userCredential.user;
          

          window.location = "index.php";
          
          

          // ...
        })
        .catch((error) => {
          var errorCode = error.code;
          alert(error.message);

        });
    }

    // -----------------------------------------------signin function----------------------------------------------------

    async function sfunc(e) {
      e.preventDefault();
      // alert("hii");
      var email = document.getElementById('Email').value;
      var password = document.getElementById('Password').value;
      var pnum = document.getElementById('Num').value;
      var Uname = document.getElementById('Username').value;

      firebase.auth().createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          // Signed in 
          // var user = userCredential.user;
          var user = firebase.auth().currentUser;
          // console.log("hii");

          if (user != null) {
            console.log("hii2");
            user.providerData.forEach(function (profile) {

              // name = Uname;
              email = user.email;

              emailVerified = user.emailVerified;
              userId = user.uid;
              console.log(Uname);
              console.log(email);
              // console.log(photoUrl);
              console.log(userId);


              // firebase.database().ref('userss/' + userId).set({
              //   username: Uname,
              //   email: email,
              //   // profile_picture: photoUrl,
              //   M_number: pnum
              // });
              // alert("after");
              db.collection("Users").doc(userId).set({
                username: Uname,
                email: email,
                // profile_picture: photoUrl,
                M_number: pnum
              })
                .then(() => {
                  console.log("Document successfully written!");
                  window.location = "index.php";
                })
                .catch((error) => {
                  console.error("Error writing document: ", error);
                });

              alert("Successfully Registered");
              
              

            });
            
          }
          // location.reload();

          // ...
        })
        .catch((error) => {
          var errorCode = error.code;
          var errorMessage = error.message;
          alert("Email already registered");
          // ..
        });
    }

// -----------------------------------------------------otp login-------------------------------------------------------------

    // async function pauth(e) {
    //   alert("hi");

    //   window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', { 'size': 'invisible' });


    //   var num = document.getElementById('num').value;
    //   console.log(num);
    //   firebase.auth().signInWithPhoneNumber(num, window.recaptchaVerifier).then(function (confirmationResult) {
    //     window.confirmationResult = confirmationResult;
    //     coderesult = confirmationResult;
    //     console.log(coderesult);
    //     alert("msg sent");

    //   }).catch((error) => {
    //     // Error; SMS not sent
    //     // ...

    //   });


    // }

// -----------------------------------------------------------logout function----------------------------------------------------------

    async function logout(e) {
      e.preventDefault();
      // alert('hiiiii');
      firebase.auth().signOut().then(() => {
          location.reload();
          window.location="index.php";
        // Sign-out successful.
      }).catch((error) => {
        // An error happened.
      });
    }


// --------------------------------------------------search---------------------------------------------------

/* When the user clicks on the button,
toggle between hiding and showing the dropdown content */
function myFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
  db.collection("products").get().then((Snapshot)=>{
    Snapshot.forEach((doc)=>{
      var data = doc.data()
      var proid = doc.id;
      document.getElementById("myDropdown").innerHTML += '<a href="prodetail.php?id='+proid+'">'+data.title+'</a><a href="author.php?id='+data.author+'">'+data.author+'</a><a href="category.php?id='+data.genre+'">'+data.genre+'</a>';
      
    })
  });
}

function filterFunction() {
  var input, filter, ul, li, a, i;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase();
  div = document.getElementById("myDropdown");
  a = div.getElementsByTagName("a");
  for (i = 0; i < a.length; i++) {
    txtValue = a[i].textContent || a[i].innerText;
    if (txtValue.toUpperCase().indexOf(filter) > -1) {
      a[i].style.display = "";
    } else {
      a[i].style.display = "none";
    }
  }
}
// window.onclick = function(event) {
//   if (!event.target.matches('.dropbtn')) {
//     var dropdowns = document.getElementsByClassName("dropdown-content");
//     var i;
//     for (i = 0; i < dropdowns.length; i++) {
//       var openDropdown = dropdowns[i];
//       if (openDropdown.classList.contains('show')) {
//         openDropdown.classList.remove('show');
//       }
//     }
//   }
// }
// ---------------------------------------resetset password function----------------------------------------------------
function resetpass(event){
  var auth = firebase.auth();
var emailAddress = event.target.parentElement.parentElement.children[1].children[0].children[0].children[0].value;
console.log(emailAddress);

auth.sendPasswordResetEmail(emailAddress).then(function() {
  // Email sent.
  console.log("email send");
  alert("Email has been sent,please check your gmail");
}).catch(function(error) {
  // An error happened.
});
}


  </script>
</body>

</html>
